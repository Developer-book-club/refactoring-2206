# 10ì¥. ì¡°ê±´ë¶€ ë¡œì§ ê°„ì†Œí™”

## 1. ì¡°ê±´ë¬¸ ë¶„í•´í•˜ê¸°

- ë³µì¡í•œ ì¡°ê±´ë¶€ ë¡œì§ì€ í”„ë¡œê·¸ë¨ì„ ë§¤ìš° ë³µì¡í•˜ê²Œ ë§Œë“ ë‹¤.
- ì¡°ê±´ì„ ê²€ì‚¬í•˜ê³  ê·¸ ê²°ê³¼ì— ë”°ë¥¸ ë™ì‘ì„ í‘œí˜„í•œ ì½”ë“œëŠ” ë¬´ìŠ¨ì¼ì´ ì¼ì–´ë‚˜ëŠ”ì§€ ì´ì•¼ê¸°í•´ì£¼ê¸´ í•˜ì§€ë§Œ, â€˜ì™œ' ì¼ì–´ë‚˜ëŠ”ì§€ ì œëŒ€ë¡œ ë§í•´ì£¼ì§€ ì•Šì„ ë•Œê°€ ë§ë‹¤.
- ì´ ê¸°ë²•ì„ ì ìš©í•˜ë©´, í•´ë‹¹ ì¡°ê±´ì´ ë¬´ì—‡ì¸ì§€ ê°•ì¡°í•˜ê³ , ê·¸ë˜ì„œ ë¬´ì—‡ì„ ë¶„ê¸°í–ˆëŠ”ì§€ê°€ ëª…ë°±í•´ì§„ë‹¤.
- í•¨ìˆ˜ ì¶”ì¶œí•˜ê¸°ì˜ ì‚¬ë¡€ì¤‘ í•˜ë‚˜!
- Tips
    - ì½”ë“œë¥¼ ë¶€ìœ„ë³„ë¡œ ë¶„í•´í•œ ë‹¤ìŒ, ê° ë©ì–´ë¦¬ì˜ ì˜ë„ë¥¼ ì‚´ë¦° ì´ë¦„ì˜ í•¨ìˆ˜ í˜¸ì¶œë¡œ ë°”ê¿”ì£¼ì.

```jsx
// AS-IS
if (!aDate.isBefore(plan.summerStart) && !aDate.isAfter(plan.summerEnd)) {
  charge = quantity * plan.summerRate;
} else {
  charge = quantity * plan.regularRate + plan.regularServiceCharge;
}

// TO-BE
charge = summer() ? summerCharge() : regularCharge();

function summer() {
  return !aDate.isBefore(plan.summerStart) && !aDate.isAfter(plan.summerEnd);
}

function summerCharge() {
  return quantity * plan.summerRate;
}

function regularCharge() {
  return quantity * plan.regularRate + plan.regularServiceCharge;
}
```

## 2. ì¡°ê±´ì‹ í†µí•©í•˜ê¸° ğŸ‘ğŸ»

- ë¹„êµí•˜ëŠ” ì¡°ê±´ì€ ë‹¤ë¥´ì§€ë§Œ ìˆ˜í–‰í•˜ëŠ” ë™ì‘ì´ ì¡°ê±´ë¬¸ ì•ˆì—ì„œ ë˜‘ê°™ì´ ë°˜ë³µë˜ëŠ” ê²½ìš°
- ì¡°ê±´ë¶€ ì½”ë“œ í†µí•©ì˜ ì¥ì 
    - í†µí•©í•˜ë¯€ë¡œì¨ í•˜ë ¤ëŠ” ì¼ì´ ì½”ë“œì—ì„œ ë” ëª…í™•íˆ ë“œëŸ¬ë‚¨.
    - í•¨ìˆ˜ ì¶”ì¶œí•˜ê¸°ê¹Œì§€ ì´ì–´ì§ˆ ê°€ëŠ¥ì„±ì´ ë†’ìŒ.
- Tips
    - `and / or` ì—°ì‚°ìë¥¼ ì‚¬ìš©í•˜ì—¬ ì—¬ëŸ¬ê°œì˜ ë¹„êµ ë¡œì§ì„ í•˜ë‚˜ë¡œ í•©ì¹  ìˆ˜ ìˆë‹¤.
        - ì¤‘ì²© ifë¬¸ì´ ë‚˜ì˜¤ëŠ” ê²½ìš° â†’ andë¡œ ë³€ê²½
        - ê°™ì€ í˜•íƒœì˜ ifì´ ë°˜ë³µë˜ëŠ” ê²½ìš° â†’ orë¡œ ë³€ê²½

### ì˜ˆì œ1. ì¤‘ì²© ifë¬¸ì´ ë‚˜ì˜¤ëŠ” ê²½ìš° (and ì‚¬ìš©)

```jsx
// AS-IS
if (anEmployee.onVacation) {
  if (anEmployee.seniority > 10) {
    return 1
  }
}
return 0.5;

// TO-BE (1)
if (anEmployee.onVacation && anEmployee.seniority > 10) {
  return 1
}
return 0.5;

// TO-BE (2: final)
const isSeniorLevelTenOnVacation = anEmployee.onVacation && anEmployee.seniority > 10;
if (isSeniorLevelTenOnVacation) {
  return 1
}
return 0.5;
```

### ì˜ˆì œ2. ê°™ì€ í˜•íƒœì˜ ifë¬¸ì´ ë°˜ë³µë˜ëŠ” ê²½ìš° (or ì‚¬ìš©)

```jsx
// AS-IS
function disabilityAmount(anEmployee) {
  if (anEmployee.seniority < 2) return 0;
  if (anEmployee.monthsDisabled > 12) return 0;
  if (anEmployee.isPartTime) return 0;
}

// TO-BE (1)
function disabilityAmount({ seniority, monthsDisabled, isPartTime }) {
  if (seniority < 2 || monthsDisabled > 12 || isPartTime) return 0;
}

// TO-BE (2: final)
function disabilityAmount({ seniority, monthsDisabled, isPartTime }) {
  const isNotEligibleForDisability = () => seniority < 2 || monthsDisabled > 12 || isPartTime;
  if (isNotEligibleForDisability()) return 0;
} 

```

## 3. ì¤‘ì²© ì¡°ê±´ë¬¸ì„ `guard clause(ë³´í˜¸ êµ¬ë¬¸)`ë¡œ ë°”ê¾¸ê¸° ğŸ‘ğŸ»

- ì¡°ê±´ë¬¸ì˜ ë‘ ê°€ì§€ í˜•íƒœ
    - ì°¸ê³¼ ê±°ì§“ ëª¨ë‘ ë™ì‘ì„ ê¸°ìˆ í•´ì•¼ í•˜ëŠ” ê²½ìš° (ifâ€¦else)
    - ì°¸ ë˜ëŠ” ê±°ì§“ í•œê°œë§Œ ë™ì‘ì„ ê¸°ìˆ í•˜ë©´ ë˜ëŠ” ê²½ìš° (if) â†’ `guard clause(ë³´í˜¸ êµ¬ë¬¸)`
- guard clause ë¦¬í™í† ë§ ê¸°ë²•ì˜ í•µì‹¬ì€, ì˜ë„ë¥¼ ë¶€ê°í•˜ëŠ”ë° ìˆë‹¤.
    - ì°¸ ë˜ëŠ” ê±°ì§“ í•œê°œë§Œ ë™ì‘ì„ ê¸°ìˆ í•˜ë©´ ë˜ëŠ”ë°, ifâ€¦elseë¡œ í‘œí˜„í•˜ë©´ ì‹¤ì œë¡œ ë²Œì–´ì§€ëŠ” ì¤‘ìš”í•œ ì¼ë“¤ì´ ì¤‘ì²©ëœ ì¡°ê±´ë“¤ì— ê°€ë ¤ì„œ ì˜ ë³´ì´ì§€ ì•ŠëŠ”ë‹¤.
- Tips
    - ì˜ë„ê°€ ë¬´ì—‡ì¸ì§€ ì •í•˜ê³ , ë‚˜ë¨¸ì§€ëŠ” early return í•œë‹¤.
    - ì¡°ê±´ì‹ì„ ë°˜ëŒ€ë¡œ ë§Œë“¤ì–´ ì ìš©í•˜ëŠ” ê²½ìš°ë„ ìˆë‹¤.

### ì˜ˆì œ1. ì˜ë„ì— ë§ê²Œ guard clauseë¥¼ ì ìš©í•˜ì

```jsx
// AS-IS
function payAmount(employee) {
  let result;
  if (employee.isSeparated) { // í‡´ì§í•œ ì§ì›ì¸ê°€
    result = { amount: 0, reasonCode: "SEP" };
  } else {
    if (employee.isRetired) { // ì€í‡´í•œ ì§ì›ì¸ê°€
      result = { amount: 0, reasonCode: "RET" };
    } else { // ê¸‰ì—¬ ê³„ì‚° ë¡œì§
      lorem.ipsum(dolor.sitAmet);
      consectetur(adipiscing).elit();
      sed.do.eiusmod = tempor.incididunt.ut(labore) && dolore(magna.aliqua);
      ut.enim.ad(minim.veniam);
      result = someFinalComputation();
    }
  }
  return result;

}

// TO-BE
function payAmount(employee) {
  if (employee.isSeparated) { return { amount: 0, reasonCode: "SEP" }; }
  if (employee.isRetired) { return { amount: 0, reasonCode: "RET" }; }

  // ê¸‰ì—¬ ê³„ì‚° ë¡œì§
  lorem.ipsum(dolor.sitAmet);
  consectetur(adipiscing).elit();
  sed.do.eiusmod = tempor.incididunt.ut(labore) && dolore(magna.aliqua);
  ut.enim.ad(minim.veniam);

  return someFinalComputation();

}
```

### ì˜ˆì œ2. ì¡°ê±´ì‹ì„ ë°˜ëŒ€ë¡œ ë§Œë“¤ì–´ guard clauseë¥¼ ì ìš©í•˜ì

```jsx
// AS-IS
function adjustedCapital({ capital, interestRate, duration, income, adjustmentFactor }) {
  let result = 0;
  if (capital > 0) {
    if (interestRate > 0 && duration > 0) {
      result = (income / duration) * adjustmentFactor;
    }
  }
  return result;
}

// TO-BE
function adjustedCapital({ capital, interestRate, duration, income, adjustmentFactor }) {
  if (capital <= 0 || interestRate <= 0 || duration <= 0) return 0;

  return (income / duration) * adjustmentFactor;
}
```

## 4. ì¡°ê±´ë¶€ ë¡œì§ì„ ë‹¤í˜•ì„±ìœ¼ë¡œ ë°”ê¾¸ê¸° ğŸ‘ğŸ»

- ë³µì¡í•œ ì¡°ê±´ë¶€ ë¡œì§ì€ í”„ë¡œê·¸ë˜ë°ì—ì„œ í•´ì„í•˜ê¸° ê°€ì¥ ë‚œí•´í•œ ëŒ€ìƒ ì¤‘ í•˜ë‚˜
- ëª¨ë“  ì¡°ê±´ë¶€ ë¡œì§ì„ ë‹¤í˜•ì„±ìœ¼ë¡œ ëŒ€ì²´í•´ì•¼í•˜ëŠ” ê²ƒì€ ì•„ë‹ˆë‹¤.

### ì˜ˆì œ1. íƒ€ì… ê¸°ì¤€ìœ¼ë¡œ ë¶„ê¸°í•˜ëŠ” switchë¬¸

- íƒ€ì…ì„ ì—¬ëŸ¬ê°œ ë§Œë“¤ê³  ê° íƒ€ì…ì´ ì¡°ê±´ë¶€ ë¡œì§ì„ ìì‹ ë§Œì˜ ë°©ì‹ìœ¼ë¡œ ì²˜ë¦¬í•˜ë„ë¡ êµ¬ì„±

```jsx
// AS-IS
function plumages(birds) {
  return new Map(birds.map(b => [b.name, plumage(b)]));
}

function speeds(birds) {
  return new Map(birds.map(b => [b.name, airSpeedVelocity(b)]));
}

// ê¹ƒí„¸ìƒíƒœ
function plumage(bird) {
  switch (bird.type) {
    case 'ìœ ëŸ½ ì œë¹„':
      return 'ë³´í†µì´ë‹¤';
    case 'ì•„í”„ë¦¬ì¹´ ì œë¹„':
      return (bird.numberOfCoconuts > 2) ? "ì§€ì³¤ë‹¤" : "ë³´í†µì´ë‹¤";
    case 'ë…¸ë¥´ì›¨ì´ íŒŒë‘ ì•µë¬´':
      return (bird.voltage > 100) ? "ê·¸ì„ë ¸ë‹¤" : "ì˜ˆì˜ë‹¤";
    default:
      return "ì•Œ ìˆ˜ ì—†ë‹¤";
  }
}

// ë¹„í–‰ì†ë„
function airSpeedVelocity(bird) {
  switch (bird.type) {
    case 'ìœ ëŸ½ ì œë¹„':
      return 35;
    case 'ì•„í”„ë¦¬ì¹´ ì œë¹„':
      return 40 - 2 * bird.numberOfCoconuts;
    case 'ë…¸ë¥´ì›¨ì´ íŒŒë‘ ì•µë¬´':
      return (bird.isNailed) ? 0 : 10 + bird.voltage / 100;
    default:
      return null;
  }
}
```

```jsx
// TO-BE
function plumages(birds) {
  return new Map(birds
    .map(b => createBird(b))
    .map(b => [b.name, b.plumage]));
}

function speeds(birds) {
  return new Map(birds
    .map(b => createBird(b))
    .map(b => [b.name, b.airSpeedVelocity]));
}

function createBird(bird) {
  switch (bird.type) {
    case 'ìœ ëŸ½ ì œë¹„':
      return new EuropeanSwallow(bird)
    case 'ì•„í”„ë¦¬ì¹´ ì œë¹„':
      return new AfricanSwallow(bird)
    case 'ë…¸ë¥´ì›¨ì´ íŒŒë‘ ì•µë¬´':
      return new NorwegianBlueParrot(bird)
    default:
      return new Bird(bird)
  }
}

class Bird {
  constructor(birdObject) {
    Object.assign(this, birdObject);
  }

  get plumage() {
    return "ì•Œ ìˆ˜ ì—†ë‹¤";
  }

  get airSpeedVelocity() {
    return null;
  }
}

class EuropeanSwallow extends Bird {
  get plumage() {
    return 'ë³´í†µì´ë‹¤';
  }

  get airSpeedVelocity() {
    return 35;
  }
}

class AfricanSwallow extends Bird {
  get plumage() {
    return (this.numberOfCoconuts > 2) ? "ì§€ì³¤ë‹¤" : "ë³´í†µì´ë‹¤";
  }

  get airSpeedVelocity() {
    return 40 - 2 * this.numberOfCoconuts;
  }
}

class NorwegianBlueParrot extends Bird {
  get plumage() {
    return (this.voltage > 100) ? "ê·¸ì„ë ¸ë‹¤" : "ì˜ˆì˜ë‹¤";
  }

  get airSpeedVelocity() {
    return (this.isNailed) ? 0 : 10 + this.voltage / 100;
  }
}
```

### ì˜ˆì œ2. íŠ¹ìˆ˜ ìƒí™©ì„ ê²€ì‚¬í•˜ëŠ” ë¡œì§ ë°˜ë³µ

- ê±°ì˜ ë˜‘ê°™ì€ ê°ì²´ì§€ë§Œ ë‹¤ë¥¸ ë¶€ë¶„ë„ ìˆìŒì„ í‘œí˜„í•  ë•Œ ìƒì†ì„ ì“´ë‹¤.
- Tips
    - ê¸°ë³¸ ë™ì‘ì€ ìŠˆí¼í´ë˜ìŠ¤ë¡œ ë„£ì–´ì„œ ë³€í˜• ë™ì‘ì— ì‹ ê²½ì“°ì§€ ì•Šê³  ê¸°ë³¸ì— ì§‘ì¤‘í•œë‹¤.
    - ë³€í˜• ë™ì‘ì€ ì„œë¸Œí´ë˜ìŠ¤ì—ì„œ í•¸ë“¤ë§ í•œë‹¤.

```jsx
// AS-IS
// íˆ¬ì ë“±ê¸‰
function rating(voyage, history) {
  const vpf = voyageProfitFactor(voyage, history);
  const vr = voyageRisk(voyage);
  const chr = captainHistoryRisk(voyage, history);
  if (vpf * 3 > (vr + chr * 2)) return "A";
  else return "B"
}

// í•­í•´ ê²½ë¡œ ìœ„í—˜ìš”ì†Œ
function voyageRisk(voyage) {
  let result = 1;
  if (voyage.length > 4) result += 2;
  if (voyage.length > 8) result += voyage.length - 8;
  if (["ì¤‘êµ­", "ë™ì¸ë„"].includes(voyage.zone)) result += 4;
  return Math.max(result, 0)
}

// ì„ ì¥ì˜ í•­í•´ ì´ë ¥ ìœ„í—˜ìš”ì†Œ
function captainHistoryRisk(voyage, history) {
  let result = 1;
  if (history.length < 5) result += 4;
  result += history.filter(v => v.profit < 0).length;
  if (voyage.zone === "ì¤‘êµ­" && hasChina(history)) result -= 2;
  return Math.max(result, 0)
}

// ì¤‘êµ­ì„ ê²½ìœ í•˜ëŠ”ê°€?
function hasChina(history) {
  return history.some(v => "ì¤‘êµ­" === v.zone);
}

// ìˆ˜ìµ ìš”ì¸
function voyageProfitFactor(voyage, history) {
  let result = 2;
  if (voyage.zone === "ì¤‘êµ­") result += 1;
  if (voyage.zone === "ë™ì¸ë„") result += 1;
  if (voyage.zone === "ì¤‘êµ­" && hasChina(history)) {
    result += 3;
    if (history.length > 10) result += 1;
    if (voyage.length > 12) result += 1;
    if (voyage.length > 18) result -= 1;
  } else {
    if (history.length > 8) result += 1;
    if (voyage.length > 14) result -= 1;
  }
  return result;
}

// í´ë¼ì´ì–¸íŠ¸ ì½”ë“œ
const voyage = { zone: "ì„œì¸ë„", length: 10 };
const history = [
  { zone: "ë™ì¸ë„", profit: 5 },
  { zone: "ì„œì¸ë„", profit: 15 },
  { zone: "ì¤‘êµ­", profit: -2 },
  { zone: "ì„œì•„í”„ë¦¬ì¹´", profit: 7 },
]
const myRating = rating(voyage, history)
```

```jsx
// TO-BE

// íˆ¬ì ë“±ê¸‰
function rating(voyage, history) {
  return createRating(voyage, history).value
}

function createRating(voyage, history) {
  if (voyage.zone === "ì¤‘êµ­" && history.some(v => "ì¤‘êµ­" === v.zone)) {
    return new ExperiencedChinaRating(voyage, history);
  } else {
    return new Rating(voyage, history)
  }
}

class ExperiencedChinaRating extends Rating {
  // ì„ ì¥ì˜ í•­í•´ ì´ë ¥ ìœ„í—˜ìš”ì†Œ
  get captainHistoryRisk() {
    const result = super.captainHistoryRisk - 2;
    return Math.max(result, 0)
  }

  get voyageLengthFactor() {
    let result = 0;
    if (this.voyage.length > 12) result += 1;
    if (this.voyage.length > 18) result -= 1;
    return result;
  }

  get historyLengthFactor() {
    return (this.history.length > 10) ? 1 : 0;
  }

  get voyageProfitFactor() {
    return super.voyageProfitFactor + 3
  }
}

class Rating {
  constructor(voyage, history) {
    this.voyage = voyage;
    this.history = history;
  }

  get value() {
    const vpf = this.voyageProfitFactor;
    const vr = this.voyageRisk;
    const chr = this.captainHistoryRisk;
    if (vpf * 3 > (vr + chr * 2)) return "A";
    else return "B"
  }

  // í•­í•´ ê²½ë¡œ ìœ„í—˜ìš”ì†Œ
  get voyageRisk() {
    let result = 1;
    if (this.voyage.length > 4) result += 2;
    if (this.voyage.length > 8) result += this.voyage.length - 8;
    if (["ì¤‘êµ­", "ë™ì¸ë„"].includes(this.voyage.zone)) result += 4;
    return Math.max(result, 0)
  }

  // ì„ ì¥ì˜ í•­í•´ ì´ë ¥ ìœ„í—˜ìš”ì†Œ
  get captainHistoryRisk() {
    let result = 1;
    if (this.history.length < 5) result += 4;
    result += this.history.filter(v => v.profit < 0).length;
    return Math.max(result, 0)
  }

  // ìˆ˜ìµ ìš”ì¸
  get voyageProfitFactor() {
    let result = 2;
    if (this.voyage.zone === "ì¤‘êµ­") result += 1;
    if (this.voyage.zone === "ë™ì¸ë„") result += 1;
    result += this.historyLengthFactor;
    result += this.voyageLengthFactor;
    return result;
  }

  get historyLengthFactor() {
    return (this.history.length > 8) ? 1 : 0;
  }

  get voyageLengthFactor() {
    return (this.voyage.length > 14) ? -1 : 0
  }

  // ì¤‘êµ­ì„ ê²½ìœ í•˜ëŠ”ê°€?
  get hasChinaHistory() {
    return this.history.some(v => "ì¤‘êµ­" === v.zone);

  }
}

// í´ë¼ì´ì–¸íŠ¸ ì½”ë“œ
const voyage = { zone: "ì„œì¸ë„", length: 10 };
const history = [
  { zone: "ë™ì¸ë„", profit: 5 },
  { zone: "ì„œì¸ë„", profit: 15 },
  { zone: "ì¤‘êµ­", profit: -2 },
  { zone: "ì„œì•„í”„ë¦¬ì¹´", profit: 7 },
]
const myRating = rating(voyage, history)
```

## 5. íŠ¹ì´ ì¼€ì´ìŠ¤ ì¶”ê°€í•˜ê¸°

- ë°ì´í„° êµ¬ì¡°ì˜ íŠ¹ì • ê°’ì„ í™•ì¸í•œ í›„ ë˜‘ê°™ì€ ë™ì‘ì„ ìˆ˜í–‰í•˜ëŠ” ê²½ìš° ë¦¬íŒ©í„°ë§ ëŒ€ìƒ
- ëª¨ë“  í´ë¼ì´ì–¸íŠ¸ ì½”ë“œë¥¼ `ë‹¤í˜•ì  í–‰ìœ„(íƒ€ì…ì— ë”°ë¼ ë™ì‘ì´ ë‹¬ë¼ì§€ëŠ” í–‰ìœ„)`ë¡œ ëŒ€ì²´í•  ìˆ˜ ìˆëŠ”ì§€ ì‚´í´ë³¸ë‹¤.
- íŠ¹ì´ ì¼€ì´ìŠ¤ íŒ¨í„´
    - íŠ¹ìˆ˜í•œ ê²½ìš°ì˜ ê³µí†µ ë™ì‘ì„ `í•˜ë‚˜ì˜ ìš”ì†Œ`ì— ëª¨ì•„ì„œ ì‚¬ìš©í•˜ëŠ” íŒ¨í„´
    - í•˜ë‚˜ì˜ ìš”ì†Œê°€ ë  ìˆ˜ ìˆëŠ” ê²ƒë“¤ = ê°ì²´(í´ë˜ìŠ¤) or ë³€í™˜ í•¨ìˆ˜
- ë°©ë²•1. ê°ì²´/í´ë˜ìŠ¤ë¡œ íŠ¹ì´ ì¼€ì´ìŠ¤ ë¶„ë¦¬
    - íŠ¹ì´ ì¼€ì´ìŠ¤ ê°ì²´ê°€ ë‹¤ë¥¸ ê°ì²´ë¥¼ ë°˜í™˜í•´ì•¼ í•œë‹¤ë©´, ê·¸ ê°ì²´ ì—­ì‹œ íŠ¹ì´ ì¼€ì´ìŠ¤ì—¬ì•¼ í•˜ëŠ” ê²ƒì´ ì¼ë°˜ì 
    - ë„ ê°ì²´ íŒ¨í„´: ë„ì€ íŠ¹ì´ ì¼€ì´ìŠ¤ë¡œ ì²˜ë¦¬í•´ì•¼ í•  ë•Œê°€ ë§ë‹¤.
- ë°©ë²•2. ë³€í™˜ í•¨ìˆ˜ë¡œ íŠ¹ì´ ì¼€ì´ìŠ¤ ë¶„ë¦¬
    - ë³€í™˜ì„ ê±°ì³ ë°ì´í„° êµ¬ì¡°ì— ì¶”ê°€ì‹œí‚¤ëŠ” í˜•íƒœë¡œë„ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤.
    - ë„¤ì´ë° Tip
        - enrich: ë³¸ì§ˆì€ ê°™ê³  ë¶€ê°€ ì •ë³´ë§Œ ë§ë¶™ì´ëŠ” ê²½ìš°
        - transform: í˜•íƒœê°€ ë³¸ì§ˆê³¼ ë‹¤ë¥´ê²Œ ë³€ê²½ë  ë•Œ

### ì˜ˆì‹œ1. í´ë˜ìŠ¤ë¡œ íŠ¹ì´ ì¼€ì´ìŠ¤ ë¶„ë¦¬

```jsx
// AS-IS
class Site {
  get customer() {
    return this._customer;
  }
}

class Customer {
  get name() {
    return this._name;
  } // ê³ ê°ì´ë¦„
  get billingPlan() {
    return this._billingPlan;
  } // ìš”ê¸ˆì œ
  set billingPlan(arg) {
    this._billingPlan = arg;
  }
  get paymentHistory() {} // ë‚©ë¶€ì´ë ¥
}

// í´ë¼ì´ì–¸íŠ¸ 1
const aCustomer = site.customer;
let customerName;
if (aCustomer === "ë¯¸í™•ì¸ ê³ ê°") customerName = "ê±°ì£¼ì";
else customerName = aCustomer.name;

// í´ë¼ì´ì–¸íŠ¸ 2
const plan =
  aCustomer === "ë¯¸í™•ì¸ ê³ ê°"
    ? registry.billingPlans.basic
    : aCustomer.billingPlan;

// í´ë¼ì´ì–¸íŠ¸ 3
if (aCustomer !== "ë¯¸í™•ì¸ ê³ ê°") aCustomer.billingPlan = newPlan;

// í´ë¼ì´ì–¸íŠ¸ 4
const weeksDelinquent =
  aCustomer === "ë¯¸í™•ì¸ ê³ ê°"
    ? 0
    : aCustomer.paymentHistory.weeksDelinquentInLastYear;
```

```jsx
// TO-BE
class Site {
  get customer() {
    return this._customer === "ë¯¸í™•ì¸ ê³ ê°"
      ? new UnkownCustomer()
      : this._customer;
  }
}

class Customer {
  get isUnknown() {
    return false;
  }
  // ê³ ê°ì´ë¦„
  get name() {
    return this._name;
  }
  // ìš”ê¸ˆì œ
  get billingPlan() {
    return this._billingPlan;
  }
  set billingPlan(arg) {
    this._billingPlan = arg;
  }
  // ë‚©ë¶€ì´ë ¥
  get paymentHistory() {}
}

class UnkownCustomer {
  get isUnknown() {
    return true;
  }
  get name() {
    return "ê±°ì£¼ì";
  }
  get billingPlan() {
    return registry.billingPlans.basic;
  }
  set billingPlan(arg) {
    /* ë¬´ì‹œí•œë‹¤ */
  }
  get paymentHistory() {
    return new NullPaymentHistory();
  }
}

class NullPaymentHistory {
  get weeksDelinquentInLastYear() {
    return 0;
  }
}

function isUnknown(arg) {
  if (!(arg instanceof Customer || arg instanceof UnkownCustomer)) {
    throw new Error(`ì˜ ëª»ëœ ê°’ê³¼ ë¹„êµ: <${arg}>`);
  }
  return arg.isUnknown;
}

// í´ë¼ì´ì–¸íŠ¸ 1
const aCustomer = site.customer;
const customerName = aCustomer.name;

// í´ë¼ì´ì–¸íŠ¸ 2
const plan = aCustomer.billingPlan;

// í´ë¼ì´ì–¸íŠ¸ 3
if (!aCustomer.isUnknown) aCustomer.billingPlan = newPlan;

// í´ë¼ì´ì–¸íŠ¸ 4
const weeksDelinquent = aCustomer.paymentHistory.weeksDelinquentInLastYear;
```

### ì˜ˆì‹œ2. ë³€í™˜ í•¨ìˆ˜ë¡œ íŠ¹ì´ ì¼€ì´ìŠ¤ ë¶„ë¦¬

```jsx
// AS-IS
// í´ë¼ì´ì–¸íŠ¸ 1
const site = acquireSiteData();
const aCustomer = site.customer;
let customerName;
if (aCustomer === "ë¯¸í™•ì¸ ê³ ê°") customerName = "ê±°ì£¼ì";
else customerName = aCustomer.name;

// í´ë¼ì´ì–¸íŠ¸ 2
const plan =
  aCustomer === "ë¯¸í™•ì¸ ê³ ê°"
    ? registry.billingPlans.basic
    : aCustomer.billingPlans;

// í´ë¼ì´ì–¸íŠ¸ 3
const weeksDelinquent =
  aCustomer === "ë¯¸í™•ì¸ ê³ ê°"
    ? 0
    : aCustomer.paymentHistory.weeksDelinquentInLastYear;
```

```jsx
// TO-BE
function enrichSite(aSite) {
  const result = _.cloneDeep(aSite);
  const unknownCustomer = {
    isUnknown: true,
    name: "ê±°ì£¼ì",
    billingPlan: registry.billingPlans.basic,
    paymentHistory: {
      weeksDelinquentInLastYear: 0,
    },
  };

  if (isUnknown(result.customer)) result.customer = unknownCustomer;
  else result.customer.isUnknown = false;

  return result;
}
function isUnknown(aCustomer) {
  return aCustomer === "ë¯¸í™•ì¸ ê³ ê°" ? true : aCustomer.isUnknown;
}
// í´ë¼ì´ì–¸íŠ¸ 1
const rawSite = acquireSiteData();
const site = enrichSite(rawSite);
const aCustomer = site.customer;
const customerName = aCustomer.name;

// í´ë¼ì´ì–¸íŠ¸ 2
const plan = aCustomer.billingPlan;

// í´ë¼ì´ì–¸íŠ¸ 3
const weeksDelinquent = aCustomer.paymentHistory.weeksDelinquentInLastYear;
```


## 6. ì–´ì„œì…˜ ì¶”ê°€í•˜ê¸°

- assertionì€ í•­ìƒ ì°¸ì¼ ê²½ìš°ë¥¼ ê°€ì •í•˜ëŠ” ì¡°ê±´ë¶€ ë¬¸ì¥
    - í”„ë¡œê·¸ë¨ì´ ì–´ë–¤ ìƒíƒœë¥¼ ê°€ì •í•œ ì±„ ì‹¤í–‰ë˜ëŠ”ì§€ ë‹¤ë¥¸ ê°œë°œì¥ì—ê²Œ ì•Œë ¤ì£¼ëŠ” í›Œë¥­í•œ ì†Œí†µ ë„êµ¬
- ì½”ë“œì—ì„œ ê°€ì •í•œ ë‚´ìš©ì„ ì½”ë“œì— ëª…ì‹œì ìœ¼ë¡œ ê¸°ìˆ í•˜ê¸° ìœ„í•´ì„œëŠ” assertionì„ ì´ìš©í•œë‹¤.
- Tips
    - assertion ìœ ë¬´ì™€ ìƒê´€ ì—†ì´ í”„ë¡œê·¸ë¨ ê¸°ëŠ¥ì˜ ì •ìƒ ë™ì‘ì— ì•„ë¬´ ì˜í–¥ì„ ì£¼ì§€ ì•Šì•„ì•¼ í•¨ë‹¤.
    - ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ë§ì´ ì‘ì„±í•œë‹¤ë©´ assertionì˜ ë””ë²„ê¹… ìš©ë„ë¡œì„œì˜ íš¨ìš©ì€ ì¤„ì–´ë“ ë‹¤.

```jsx
// AS-IS
if (this.discountRate) {
  base = base - (this.discountRate * bas);
}

// TO-BE
assert(this.discountRate >= 0);
if (this.discountRate) {
  base = base - (this.discountRate * bas);
}
```

## 7. ì œì–´ í”Œë˜ê·¸ë¥¼ íƒˆì¶œë¬¸ìœ¼ë¡œ ë°”ê¾¸ê¸°

- ì œì–´ í”Œë˜ê·¸
    - ì½”ë“œì˜ ë™ì‘ì„ ë³€ê²½í•˜ëŠ”ë° ì‚¬ìš©ë˜ëŠ” ë³€ìˆ˜
    - ì–´ë”˜ê°€ì—ì„œ ê°’ì„ ê³„ì‚°í•´ì„œ ì œì–´ í”Œë˜ê·¸ì— ì €ì¥í•˜ê³  ë‹¤ë¥¸ ì–´ë”˜ê°€ì˜ ì¡°ê±´ë¬¸ì—ì„œ ê²€ì‚¬í•˜ëŠ” í˜•íƒœë¡œ ì‚¬ìš©
- Tips
    - ëª¨ë“  í•¨ìˆ˜ì˜ returnë¬¸ì´ í•˜ë‚˜ì¼ í•„ìš”ëŠ” ì—†ë‹¤. í•¨ìˆ˜ì—ì„œ í•  ì¼ì„ ë‹¤ ë§ˆì³¤ë‹¤ë©´ early return í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.